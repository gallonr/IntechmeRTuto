---
title: "Manipulation d'objets de base et tibbles"
subtitle: "Introduction aux vecteurs, listes et tibbles"
output: 
  learnr::tutorial:
    progressive: true
    allow_skip: true
    theme: cosmo
    css: ../css/custom.css
    language:
      fr:
        button:
          runcode: "Exécuter le code"
          hints: "Indice"
          solution: "Solution"
          continue: "Continuer"
          submitanswer: "Soumettre"
          previoustopic: "Thème précédent"
          nexttopic: "Thème suivant"
        text:
          startover: "Recommencer"
          areyousure: "Êtes-vous sûr de vouloir recommencer ? (Toute progression sera perdue)"
runtime: shiny_prerendered
description: "Apprenez à créer et manipuler des vecteurs, listes et tibbles en R"
---

```{r setup, include=FALSE}
library(learnr)
library(tidyverse)

knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  error = FALSE
)
```
```{r logo, echo=FALSE, results='asis'}
htmltools::img(src = "images/logo.png",
               id = "tutorial-logo",
               alt = "Cnam-Intechmer")
```
## Bienvenue ! {data-progressive=TRUE}

### Introduction

Bienvenue dans ce tutoriel sur les **objets de base en R** ! Vous allez apprendre à manipuler les structures de données fondamentales du tidyverse.

<div class="info-box">
ℹ️ Ce tutoriel est interactif : vous pourrez exécuter du code directement dans votre navigateur.
</div>

**Objectifs d'apprentissage :**

- ✅ Créer et manipuler des vecteurs
- ✅ Comprendre les opérations vectorielles
- ✅ Créer des tibbles (tableaux de données modernes)
- ✅ Travailler avec des listes
- ✅ Explorer la structure des objets R

**Prérequis :**

- Aucun

**Durée estimée :** 45 minutes

---

## Partie 1 : Les vecteurs {data-progressive=TRUE}

### Qu'est-ce qu'un vecteur ?

Un **vecteur** est la structure de données la plus simple en R. C'est une séquence d'éléments du même type. [Cliquez ici pour plus de détails](https://gallonr.github.io/intechmer_statistique_cours/firstR.html#les-vecteurs)

<div class="key-concept">
En R, même un nombre seul est un vecteur de longueur 1 !
</div>

Voyons un premier exemple :

```{r demo-vecteur-simple, exercise=TRUE}
# Créer un vecteur numérique
ages <- c(25, 30, 22, 35, 28)
ages
```

<div class="tip">
La fonction `c()` signifie "combine" ou "concatenate". Elle permet de regrouper plusieurs valeurs en un seul vecteur.
</div>

### Exercice 1 : Créer un vecteur numérique

Créez un vecteur nommé `temperatures` contenant les températures suivantes : 18, 22, 20, 25, 19.

```{r ex1-vecteur-num, exercise=TRUE, exercise.lines=4}
# Créez le vecteur temperatures


```

```{r ex1-vecteur-num-hint-1}
# Utilisez la fonction c()
# temperatures <- c(...)
```

```{r ex1-vecteur-num-hint-2}
# Séparez les valeurs par des virgules
temperatures <- c(18, 22, 20, 25, 19)
```

```{r ex1-vecteur-num-solution}
temperatures <- c(18, 22, 20, 25, 19)
temperatures
```

### Types de vecteurs

Il existe plusieurs types de vecteurs en R :

```{r demo-types-vecteurs, exercise=TRUE}
# Vecteur numérique
nombres <- c(1, 2, 3, 4, 5)

# Vecteur de caractères
noms <- c("Alice", "Bob", "Charlie")

# Vecteur logique
reponses <- c(TRUE, FALSE, TRUE, TRUE)

# Afficher le type
class(nombres)
class(noms)
class(reponses)
```

### Exercice 2 : Vecteur de caractères

Créez un vecteur `prenoms` avec les prénoms de 4 personnes de votre choix.

```{r ex2-vecteur-char, exercise=TRUE, exercise.lines=4}
# Créez le vecteur prenoms


```

```{r ex2-vecteur-char-hint-1}
# Les chaînes de caractères doivent être entre guillemets
prenoms <- c("Marie", "...")
```

```{r ex2-vecteur-char-solution}
prenoms <- c("Marie", "Pierre", "Sophie", "Lucas")
prenoms
```

### Opérations vectorielles

R excelle dans les **opérations vectorielles** : les calculs s'appliquent automatiquement à tous les éléments.

```{r demo-operations, exercise=TRUE}
# Créer un vecteur de prix
prix <- c(10, 15, 20, 25)

# Appliquer une réduction de 20%
prix_reduits <- prix * 0.8
prix_reduits

# Ajouter 5€ de frais de port
prix_total <- prix + 5
prix_total
```

<div class="key-concept">
Les opérations (+, -, *, /, ^) s'appliquent élément par élément !
</div>

### Exercice 3 : Calculs vectoriels

Vous avez mesuré des distances en kilomètres. Convertissez-les en mètres (multipliez par 1000).

```{r ex3-calcul, exercise=TRUE, exercise.lines=6}
# Distances en km
distances_km <- c(2.5, 1.2, 3.8, 0.5)

# Convertissez en mètres


```

```{r ex3-calcul-hint-1}
# Multipliez le vecteur par 1000
distances_m <- distances_km * ...
```

```{r ex3-calcul-solution}
distances_km <- c(2.5, 1.2, 3.8, 0.5)
distances_m <- distances_km * 1000
distances_m
```

### Quiz : Les vecteurs

```{r quiz-vecteurs}
quiz(
  caption = "Testez vos connaissances sur les vecteurs",
  
  question("Quelle fonction permet de créer un vecteur ?",
    answer("vector()"),
    answer("c()", correct = TRUE, message = "Bravo ! c() est la fonction standard pour combiner des valeurs."),
    answer("create()"),
    answer("v()"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  ),
  
  question("Tous les éléments d'un vecteur doivent être du même type.",
    answer("Vrai", correct = TRUE, message = "Exact ! C'est une propriété fondamentale des vecteurs en R."),
    answer("Faux", message = "Non, les vecteurs sont homogènes."),
    allow_retry = TRUE
  ),
  
  question("Si j'écris `v <- c(1, 2, 3) + 10`, que vaut v ?",
    answer("13"),
    answer("c(11, 12, 13)", correct = TRUE, message = "Parfait ! L'opération s'applique à chaque élément."),
    answer("16"),
    answer("Erreur"),
    allow_retry = TRUE,
    random_answer_order = TRUE
  )
)
```

---

## Partie 2 : Les tibbles {data-progressive=TRUE}

### Qu'est-ce qu'un tibble ?

Un **tibble** est un tableau de données moderne, version améliorée du `data.frame` de base R. [Cliquez ici pour plus de détails](https://gallonr.github.io/intechmer_statistique_cours/datamining.html)

```{r demo-tibble, exercise=TRUE}
library(tibble)

# Créer un tibble
etudiants <- tibble(
  nom = c("Alice", "Bob", "Charlie", "Diana"),
  age = c(20, 22, 21, 23),
  note = c(15, 17, 14, 18)
)

etudiants
```

<div class="tip">
Notez l'affichage élégant : types de colonnes, dimensions, etc.
</div>

### Exercice 4 : Créer un tibble

Créez un tibble `villes` avec trois colonnes :
- `nom` : Paris, Lyon, Marseille
- `population` : 2165, 516, 870 (en milliers)
- `superficie` : 105, 48, 241 (en km²)

```{r ex4-tibble, exercise=TRUE, exercise.lines=10}
library(tibble)

# Créez le tibble villes




```

```{r ex4-tibble-hint-1}
# Structure de base
villes <- tibble(
  nom = c(...),
  population = c(...),
  superficie = c(...)
)
```

```{r ex4-tibble-solution}
library(tibble)

villes <- tibble(
  nom = c("Paris", "Lyon", "Marseille"),
  population = c(2165, 516, 870),
  superficie = c(105, 48, 241)
)

villes
```

### Accéder aux colonnes

Il existe plusieurs façons d'accéder aux colonnes d'un tibble :

```{r demo-acces-colonnes, exercise=TRUE}
etudiants <- tibble(
  nom = c("Alice", "Bob", "Charlie"),
  age = c(20, 22, 21),
  note = c(15, 17, 14)
)

# Méthode 1 : avec $
etudiants$nom

# Méthode 2 : avec [[]]
etudiants[["age"]]

# Méthode 3 : avec pull() du tidyverse
library(dplyr)
etudiants |> pull(note)
```

### Exercice 5 : Extraction de colonnes

Extrayez la colonne `population` du tibble `villes` (utilisez la méthode de votre choix).

```{r ex5-extraction, exercise=TRUE, exercise.lines=8}
villes <- tibble(
  nom = c("Paris", "Lyon", "Marseille"),
  population = c(2165, 516, 870)
)

# Extrayez la colonne population


```

```{r ex5-extraction-hint}
# Utilisez villes$population
# ou villes[["population"]]
```

```{r ex5-extraction-solution}
villes <- tibble(
  nom = c("Paris", "Lyon", "Marseille"),
  population = c(2165, 516, 870)
)

villes$population
# ou villes[["population"]]
```

### Explorer un tibble

Utilisez `glimpse()` pour avoir une vue d'ensemble :

```{r demo-glimpse, exercise=TRUE}
library(tibble)

donnees <- tibble(
  id = 1:100,
  categorie = sample(c("A", "B", "C"), 100, replace = TRUE),
  valeur = rnorm(100, mean = 50, sd = 10)
)

glimpse(donnees)
```

---

## Partie 3 : Les listes {data-progressive=TRUE}

### Introduction aux listes

Une **liste** peut contenir des éléments de types différents : nombres, vecteurs, tibbles, et même d'autres listes !

```{r demo-liste, exercise=TRUE}
# Créer une liste hétérogène
ma_liste <- list(
  nombre = 42,
  vecteur = c(1, 2, 3),
  texte = "Bonjour",
  logique = TRUE
)

ma_liste
```

<div class="key-concept">
Les listes sont très flexibles et parfaites pour stocker des résultats complexes.
</div>

### Exercice 6 : Créer une liste

Créez une liste `personne` contenant :
- `prenom` : votre prénom
- `age` : votre âge (ou un âge fictif)
- `hobbies` : un vecteur de 2-3 hobbies

```{r ex6-liste, exercise=TRUE, exercise.lines=8}
# Créez la liste personne




```

```{r ex6-liste-hint}
personne <- list(
  prenom = "...",
  age = ...,
  hobbies = c("...", "...")
)
```

```{r ex6-liste-solution}
personne <- list(
  prenom = "Marie",
  age = 25,
  hobbies = c("lecture", "natation", "photo")
)

personne
```

### Accéder aux éléments d'une liste

```{r demo-acces-liste, exercise=TRUE}
ma_liste <- list(
  nom = "Alice",
  scores = c(15, 17, 14),
  valide = TRUE
)

# Avec [[]] : extrait l'élément
ma_liste[["scores"]]

# Avec $ : pratique pour les noms
ma_liste$nom

# Avec [] : renvoie une sous-liste
ma_liste[1]
```

---

## Défi final {data-progressive=TRUE}

### Mise en pratique complète

Créez un tibble `produits` représentant un catalogue avec :
- 5 produits (noms de votre choix)
- leurs prix unitaires
- leurs quantités en stock

Ensuite :
1. Calculez la valeur totale du stock pour chaque produit (prix × quantité)
2. Ajoutez cette information comme nouvelle colonne

```{r defi-final, exercise=TRUE, exercise.lines=18}
library(tibble)
library(dplyr)

# Créez le tibble produits




# Calculez la valeur du stock




# Affichez le résultat

```

```{r defi-final-hint-1}
# Créez d'abord le tibble avec tibble()
produits <- tibble(
  nom = c(...),
  prix = c(...),
  quantite = c(...)
)
```

```{r defi-final-hint-2}
# Utilisez mutate() pour ajouter une colonne
produits <- produits |>
  mutate(valeur_stock = prix * quantite)
```

```{r defi-final-solution}
library(tibble)
library(dplyr)

# Créer le tibble
produits <- tibble(
  nom = c("Ordinateur", "Souris", "Clavier", "Écran", "Webcam"),
  prix = c(800, 25, 60, 300, 80),
  quantite = c(10, 50, 30, 15, 25)
)

# Calculer la valeur du stock
produits <- produits |>
  mutate(valeur_stock = prix * quantite)

# Afficher
produits
```

---

## Récapitulatif {data-progressive=TRUE}

### Ce que vous avez appris

Félicitations ! Vous maîtrisez maintenant :

- ✅ La création de **vecteurs** numériques, de caractères et logiques
- ✅ Les **opérations vectorielles** (calculs élément par élément)
- ✅ La création de **tibbles** (tableaux de données modernes)
- ✅ L'accès aux colonnes d'un tibble
- ✅ La création et manipulation de **listes**
- ✅ L'exploration des structures avec `glimpse()` et `class()`

### Pour aller plus loin

**Tutoriels suivants :**
- Tutoriel 2 : Importation de données (CSV, Excel)
- Tutoriel 3 : Transformation avec dplyr

**Ressources complémentaires :**
- [R for Data Science - Ch. 20 (Vectors)](https://r4ds.hadley.nz/vectors.html)
- [Tibble documentation](https://tibble.tidyverse.org/)

### Aide-mémoire

```{r cheatsheet, echo=TRUE, eval=FALSE}
# Vecteurs
v <- c(1, 2, 3)           # Créer un vecteur
v * 2                     # Opération vectorielle
length(v)                 # Longueur

# Tibbles
library(tibble)
df <- tibble(x = 1:3, y = c("a", "b", "c"))
df$x                      # Accès colonne
glimpse(df)               # Explorer

# Listes
lst <- list(a = 1, b = "text")
lst$a                     # Accès élément
lst[["b"]]               # Alternative
```

---

<div class="footer">
  <p>@ Cnam-Intechmer - 2025</p>
</div>